= simple_form_for @product do |f|
  - if @product.errors.any?
    #error_explanation
    %h2
      = pluralize(@product.errors.count, "error")
      prohibited this product from being saved:
    %ul
      - @product.errors.full_messages.each do |msg|
        %li
          = msg

  = f.hidden_field :category_id
  
  = f.label :name
  = f.text_field :name
  = f.simple_fields_for :property_values do |ff|
    - prop = Property.find(ff.object.property_id)
    = render "/products/fields/#{prop.field_type}", ff: ff, f: f, prop: prop
    = ff.hidden_field :property_id, input_html: {value: ff.object.property_id}

  = f.submit 'Save', class: "btn btn-primary"